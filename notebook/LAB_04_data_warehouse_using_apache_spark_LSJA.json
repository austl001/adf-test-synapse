{
	"name": "LAB_04_data_warehouse_using_apache_spark_LSJA",
	"properties": {
		"nbformat": 4,
		"nbformat_minor": 2,
		"bigDataPool": {
			"referenceName": "SparkPool01",
			"type": "BigDataPoolReference"
		},
		"sessionProperties": {
			"driverMemory": "28g",
			"driverCores": 4,
			"executorMemory": "28g",
			"executorCores": 4,
			"numExecutors": 2,
			"runAsWorkspaceSystemIdentity": false,
			"conf": {
				"spark.dynamicAllocation.enabled": "false",
				"spark.dynamicAllocation.minExecutors": "2",
				"spark.dynamicAllocation.maxExecutors": "2",
				"spark.autotune.trackingId": "ef1a7d51-0dc5-4751-8f90-b3e87c6baf10"
			}
		},
		"metadata": {
			"saveOutput": true,
			"synapse_widget": {
				"version": "0.1",
				"state": {
					"2312823f-7ac1-40fc-8c97-0e911c8c5b03": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "829",
										"3": 4,
										"4": "30.500000000000000000",
										"5": "122.000000000000000000",
										"6": "20191231",
										"7": "38.640000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "3683",
										"3": 1,
										"4": "34.440000000000000000",
										"5": "34.440000000000000000",
										"6": "20191231",
										"7": "9.940000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "812",
										"3": 1,
										"4": "28.630000000000000000",
										"5": "28.630000000000000000",
										"6": "20191231",
										"7": "7.200000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "117",
										"3": 2,
										"4": "25.500000000000000000",
										"5": "51.000000000000000000",
										"6": "20191231",
										"7": "15.660000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "406",
										"3": 3,
										"4": "36.590000000000000000",
										"5": "109.770000000000000000",
										"6": "20191231",
										"7": "34.710000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "231",
										"3": 3,
										"4": "25.580000000000000000",
										"5": "76.740000000000000000",
										"6": "20191231",
										"7": "25.020000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "2689",
										"3": 3,
										"4": "24.000000000000000000",
										"5": "72.000000000000000000",
										"6": "20191231",
										"7": "19.770000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "2095",
										"3": 4,
										"4": "32.380000000000000000",
										"5": "129.520000000000000000",
										"6": "20191231",
										"7": "36.000000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "92",
										"3": 1,
										"4": "15.550000000000000000",
										"5": "15.550000000000000000",
										"6": "20191231",
										"7": "4.730000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									},
									{
										"0": "7365e3cb-c098-4001-83ab-68693b87809d",
										"1": "2",
										"2": "1912",
										"3": 1,
										"4": "24.620000000000000000",
										"5": "24.620000000000000000",
										"6": "20191231",
										"7": "7.390000000000000000",
										"8": 12,
										"9": 52,
										"10": "9559"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"2"
									],
									"seriesFieldKeys": [
										"5"
									],
									"isStacked": false
								}
							}
						}
					},
					"6a3b7ffb-624a-4f6e-9ed0-2b29d6e2ffab": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "20191231",
										"1": "4443",
										"2": "2371.880000000000000000",
										"3": "2.4672",
										"4": "301"
									},
									{
										"0": "20191231",
										"1": "2647",
										"2": "15347.850000000000000000",
										"3": "2.5285",
										"4": "1555"
									},
									{
										"0": "20191231",
										"1": "223",
										"2": "47663.640000000000000000",
										"3": "2.5266",
										"4": "5076"
									},
									{
										"0": "20191231",
										"1": "3977",
										"2": "14202.540000000000000000",
										"3": "2.5668",
										"4": "1594"
									},
									{
										"0": "20191231",
										"1": "4232",
										"2": "9918.700000000000000000",
										"3": "2.4991",
										"4": "1397"
									},
									{
										"0": "20191231",
										"1": "1585",
										"2": "12404.340000000000000000",
										"3": "2.4703",
										"4": "1539"
									},
									{
										"0": "20191231",
										"1": "4646",
										"2": "1975.480000000000000000",
										"3": "2.3604",
										"4": "262"
									},
									{
										"0": "20191231",
										"1": "3036",
										"2": "1150.100000000000000000",
										"3": "2.5481",
										"4": "265"
									},
									{
										"0": "20191231",
										"1": "1620",
										"2": "17613.960000000000000000",
										"3": "2.4777",
										"4": "1613"
									},
									{
										"0": "20191231",
										"1": "669",
										"2": "2422.080000000000000000",
										"3": "2.5043",
										"4": "288"
									},
									{
										"0": "20191231",
										"1": "1655",
										"2": "3088.500000000000000000",
										"3": "2.4786",
										"4": "290"
									},
									{
										"0": "20191231",
										"1": "1527",
										"2": "2148.580000000000000000",
										"3": "2.569",
										"4": "298"
									},
									{
										"0": "20191231",
										"1": "1399",
										"2": "2797.200000000000000000",
										"3": "2.4561",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "2122",
										"2": "2080.330000000000000000",
										"3": "2.4128",
										"4": "263"
									},
									{
										"0": "20191231",
										"1": "3824",
										"2": "2486.070000000000000000",
										"3": "2.494",
										"4": "207"
									},
									{
										"0": "20191231",
										"1": "4194",
										"2": "1617.840000000000000000",
										"3": "2.4231",
										"4": "252"
									},
									{
										"0": "20191231",
										"1": "863",
										"2": "1860.240000000000000000",
										"3": "2.339",
										"4": "276"
									},
									{
										"0": "20191231",
										"1": "2034",
										"2": "2452.730000000000000000",
										"3": "2.7263",
										"4": "259"
									},
									{
										"0": "20191231",
										"1": "1213",
										"2": "1590.880000000000000000",
										"3": "2.4158",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "3298",
										"2": "1747.620000000000000000",
										"3": "2.6869",
										"4": "266"
									},
									{
										"0": "20191231",
										"1": "3079",
										"2": "2413.740000000000000000",
										"3": "2.625",
										"4": "294"
									},
									{
										"0": "20191231",
										"1": "3983",
										"2": "14352.280000000000000000",
										"3": "2.554",
										"4": "1609"
									},
									{
										"0": "20191231",
										"1": "2053",
										"2": "2604.000000000000000000",
										"3": "2.6316",
										"4": "300"
									},
									{
										"0": "20191231",
										"1": "4901",
										"2": "6881.940000000000000000",
										"3": "2.5153",
										"4": "1557"
									},
									{
										"0": "20191231",
										"1": "177",
										"2": "52192.600000000000000000",
										"3": "2.486",
										"4": "6404"
									},
									{
										"0": "20191231",
										"1": "4409",
										"2": "1760.260000000000000000",
										"3": "2.5044",
										"4": "283"
									},
									{
										"0": "20191231",
										"1": "1388",
										"2": "3491.800000000000000000",
										"3": "2.5564",
										"4": "340"
									},
									{
										"0": "20191231",
										"1": "4830",
										"2": "2997.360000000000000000",
										"3": "2.4425",
										"4": "276"
									},
									{
										"0": "20191231",
										"1": "3024",
										"2": "3446.300000000000000000",
										"3": "2.6729",
										"4": "286"
									},
									{
										"0": "20191231",
										"1": "3399",
										"2": "1673.600000000000000000",
										"3": "2.6016",
										"4": "320"
									},
									{
										"0": "20191231",
										"1": "4454",
										"2": "1376.160000000000000000",
										"3": "2.4646",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "4380",
										"2": "2092.230000000000000000",
										"3": "2.4059",
										"4": "243"
									},
									{
										"0": "20191231",
										"1": "4339",
										"2": "1094.450000000000000000",
										"3": "2.3661",
										"4": "265"
									},
									{
										"0": "20191231",
										"1": "454",
										"2": "1937.760000000000000000",
										"3": "2.4673",
										"4": "264"
									},
									{
										"0": "20191231",
										"1": "2216",
										"2": "2635.290000000000000000",
										"3": "2.4953",
										"4": "267"
									},
									{
										"0": "20191231",
										"1": "3335",
										"2": "2432.010000000000000000",
										"3": "2.5392",
										"4": "259"
									},
									{
										"0": "20191231",
										"1": "1960",
										"2": "2259.900000000000000000",
										"3": "2.5596",
										"4": "279"
									},
									{
										"0": "20191231",
										"1": "3310",
										"2": "2214.800000000000000000",
										"3": "2.5",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "3025",
										"2": "1341.120000000000000000",
										"3": "2.3519",
										"4": "254"
									},
									{
										"0": "20191231",
										"1": "1128",
										"2": "2737.050000000000000000",
										"3": "2.3578",
										"4": "257"
									},
									{
										"0": "20191231",
										"1": "4561",
										"2": "2310.860000000000000000",
										"3": "2.6706",
										"4": "227"
									},
									{
										"0": "20191231",
										"1": "3683",
										"2": "15655.500000000000000000",
										"3": "2.4842",
										"4": "1575"
									},
									{
										"0": "20191231",
										"1": "2592",
										"2": "1564.920000000000000000",
										"3": "2.4059",
										"4": "243"
									},
									{
										"0": "20191231",
										"1": "249",
										"2": "53177.360000000000000000",
										"3": "2.4761",
										"4": "5128"
									},
									{
										"0": "20191231",
										"1": "4755",
										"2": "1670.720000000000000000",
										"3": "2.3402",
										"4": "227"
									},
									{
										"0": "20191231",
										"1": "1608",
										"2": "3161.070000000000000000",
										"3": "2.5259",
										"4": "341"
									},
									{
										"0": "20191231",
										"1": "367",
										"2": "2404.980000000000000000",
										"3": "2.4052",
										"4": "279"
									},
									{
										"0": "20191231",
										"1": "2381",
										"2": "13243.420000000000000000",
										"3": "2.5023",
										"4": "1619"
									},
									{
										"0": "20191231",
										"1": "2206",
										"2": "11490.960000000000000000",
										"3": "2.519",
										"4": "1524"
									},
									{
										"0": "20191231",
										"1": "2724",
										"2": "15377.200000000000000000",
										"3": "2.5085",
										"4": "1480"
									},
									{
										"0": "20191231",
										"1": "4548",
										"2": "20172.880000000000000000",
										"3": "2.4831",
										"4": "1547"
									},
									{
										"0": "20191231",
										"1": "2931",
										"2": "2302.720000000000000000",
										"3": "2.57",
										"4": "257"
									},
									{
										"0": "20191231",
										"1": "996",
										"2": "2077.660000000000000000",
										"3": "2.4259",
										"4": "262"
									},
									{
										"0": "20191231",
										"1": "1402",
										"2": "1653.540000000000000000",
										"3": "2.54",
										"4": "254"
									},
									{
										"0": "20191231",
										"1": "451",
										"2": "1756.860000000000000000",
										"3": "2.6111",
										"4": "282"
									},
									{
										"0": "20191231",
										"1": "4679",
										"2": "2794.140000000000000000",
										"3": "2.5545",
										"4": "258"
									},
									{
										"0": "20191231",
										"1": "4396",
										"2": "2181.590000000000000000",
										"3": "2.5619",
										"4": "269"
									},
									{
										"0": "20191231",
										"1": "3798",
										"2": "2251.530000000000000000",
										"3": "2.7732",
										"4": "269"
									},
									{
										"0": "20191231",
										"1": "2487",
										"2": "9516.780000000000000000",
										"3": "2.4776",
										"4": "1494"
									},
									{
										"0": "20191231",
										"1": "4779",
										"2": "3398.640000000000000000",
										"3": "2.3496",
										"4": "289"
									},
									{
										"0": "20191231",
										"1": "1511",
										"2": "1863.040000000000000000",
										"3": "2.5038",
										"4": "328"
									},
									{
										"0": "20191231",
										"1": "368",
										"2": "2477.230000000000000000",
										"3": "2.4274",
										"4": "301"
									},
									{
										"0": "20191231",
										"1": "1278",
										"2": "3481.590000000000000000",
										"3": "2.5315",
										"4": "281"
									},
									{
										"0": "20191231",
										"1": "1908",
										"2": "3640.800000000000000000",
										"3": "2.8522",
										"4": "328"
									},
									{
										"0": "20191231",
										"1": "3581",
										"2": "2929.340000000000000000",
										"3": "2.547",
										"4": "298"
									},
									{
										"0": "20191231",
										"1": "4041",
										"2": "13716.560000000000000000",
										"3": "2.5168",
										"4": "1573"
									},
									{
										"0": "20191231",
										"1": "237",
										"2": "32047.550000000000000000",
										"3": "2.4902",
										"4": "5095"
									},
									{
										"0": "20191231",
										"1": "692",
										"2": "9760.710000000000000000",
										"3": "2.5155",
										"4": "1459"
									},
									{
										"0": "20191231",
										"1": "57",
										"2": "45311.360000000000000000",
										"3": "2.5441",
										"4": "5312"
									},
									{
										"0": "20191231",
										"1": "2890",
										"2": "12905.430000000000000000",
										"3": "2.5008",
										"4": "1553"
									},
									{
										"0": "20191231",
										"1": "1990",
										"2": "15236.500000000000000000",
										"3": "2.484",
										"4": "1550"
									},
									{
										"0": "20191231",
										"1": "3457",
										"2": "2115.000000000000000000",
										"3": "2.6549",
										"4": "300"
									},
									{
										"0": "20191231",
										"1": "3362",
										"2": "2664.420000000000000000",
										"3": "2.5208",
										"4": "242"
									},
									{
										"0": "20191231",
										"1": "790",
										"2": "2317.030000000000000000",
										"3": "2.5288",
										"4": "263"
									},
									{
										"0": "20191231",
										"1": "2045",
										"2": "3589.950000000000000000",
										"3": "2.4811",
										"4": "263"
									},
									{
										"0": "20191231",
										"1": "1991",
										"2": "1596.120000000000000000",
										"3": "2.4397",
										"4": "283"
									},
									{
										"0": "20191231",
										"1": "2435",
										"2": "3203.820000000000000000",
										"3": "2.5289",
										"4": "306"
									},
									{
										"0": "20191231",
										"1": "518",
										"2": "3602.200000000000000000",
										"3": "2.6496",
										"4": "310"
									},
									{
										"0": "20191231",
										"1": "3194",
										"2": "3461.640000000000000000",
										"3": "2.3481",
										"4": "317"
									},
									{
										"0": "20191231",
										"1": "4955",
										"2": "2159.700000000000000000",
										"3": "2.5868",
										"4": "313"
									},
									{
										"0": "20191231",
										"1": "1645",
										"2": "2120.800000000000000000",
										"3": "2.211",
										"4": "241"
									},
									{
										"0": "20191231",
										"1": "4500",
										"2": "2430.090000000000000000",
										"3": "2.5833",
										"4": "279"
									},
									{
										"0": "20191231",
										"1": "2814",
										"2": "2403.960000000000000000",
										"3": "2.5126",
										"4": "299"
									},
									{
										"0": "20191231",
										"1": "3730",
										"2": "1256.700000000000000000",
										"3": "2.5652",
										"4": "295"
									},
									{
										"0": "20191231",
										"1": "124",
										"2": "36910.720000000000000000",
										"3": "2.4696",
										"4": "5243"
									},
									{
										"0": "20191231",
										"1": "968",
										"2": "3457.800000000000000000",
										"3": "2.5714",
										"4": "306"
									},
									{
										"0": "20191231",
										"1": "2049",
										"2": "2823.360000000000000000",
										"3": "2.4071",
										"4": "272"
									},
									{
										"0": "20191231",
										"1": "2603",
										"2": "18540.000000000000000000",
										"3": "2.5253",
										"4": "1500"
									},
									{
										"0": "20191231",
										"1": "4780",
										"2": "15812.790000000000000000",
										"3": "2.482",
										"4": "1519"
									},
									{
										"0": "20191231",
										"1": "3651",
										"2": "12611.700000000000000000",
										"3": "2.5194",
										"4": "1557"
									},
									{
										"0": "20191231",
										"1": "511",
										"2": "2056.600000000000000000",
										"3": "2.6804",
										"4": "260"
									},
									{
										"0": "20191231",
										"1": "2778",
										"2": "12398.320000000000000000",
										"3": "2.4547",
										"4": "1544"
									},
									{
										"0": "20191231",
										"1": "455",
										"2": "2034.960000000000000000",
										"3": "2.6522",
										"4": "244"
									},
									{
										"0": "20191231",
										"1": "4457",
										"2": "1733.200000000000000000",
										"3": "2.4138",
										"4": "280"
									},
									{
										"0": "20191231",
										"1": "1678",
										"2": "2424.840000000000000000",
										"3": "2.4694",
										"4": "242"
									},
									{
										"0": "20191231",
										"1": "2579",
										"2": "1998.880000000000000000",
										"3": "2.4554",
										"4": "248"
									},
									{
										"0": "20191231",
										"1": "4325",
										"2": "1725.750000000000000000",
										"3": "2.438",
										"4": "295"
									},
									{
										"0": "20191231",
										"1": "4661",
										"2": "2419.800000000000000000",
										"3": "2.6371",
										"4": "327"
									},
									{
										"0": "20191231",
										"1": "1159",
										"2": "3039.000000000000000000",
										"3": "2.521",
										"4": "300"
									},
									{
										"0": "20191231",
										"1": "3251",
										"2": "2659.020000000000000000",
										"3": "2.4818",
										"4": "273"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "1",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "2",
										"name": "(sum)ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "(avg)Quantity",
										"type": "double"
									},
									{
										"key": "4",
										"name": "(sum)Quantity",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"4ea19fcc-22e0-4b66-b3ea-ed00538ea621": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "101795",
										"1": "2842",
										"2": "1"
									},
									{
										"0": "102738",
										"1": "4213",
										"2": "1"
									},
									{
										"0": "101820",
										"1": "1860",
										"2": "1"
									},
									{
										"0": "101007",
										"1": "4395",
										"2": "1"
									},
									{
										"0": "101831",
										"1": "1404",
										"2": "1"
									},
									{
										"0": "101038",
										"1": "1962",
										"2": "1"
									},
									{
										"0": "101835",
										"1": "2703",
										"2": "1"
									},
									{
										"0": "101034",
										"1": "3840",
										"2": "1"
									},
									{
										"0": "101835",
										"1": "1677",
										"2": "1"
									},
									{
										"0": "101045",
										"1": "2693",
										"2": "1"
									},
									{
										"0": "101838",
										"1": "2981",
										"2": "1"
									},
									{
										"0": "101060",
										"1": "1853",
										"2": "1"
									},
									{
										"0": "101842",
										"1": "826",
										"2": "1"
									},
									{
										"0": "101083",
										"1": "4415",
										"2": "1"
									},
									{
										"0": "101858",
										"1": "3274",
										"2": "1"
									},
									{
										"0": "101121",
										"1": "4989",
										"2": "1"
									},
									{
										"0": "101859",
										"1": "1412",
										"2": "1"
									},
									{
										"0": "101143",
										"1": "4040",
										"2": "1"
									},
									{
										"0": "101865",
										"1": "2207",
										"2": "1"
									},
									{
										"0": "101157",
										"1": "4247",
										"2": "1"
									},
									{
										"0": "101876",
										"1": "4026",
										"2": "1"
									},
									{
										"0": "101177",
										"1": "1895",
										"2": "1"
									},
									{
										"0": "101878",
										"1": "937",
										"2": "1"
									},
									{
										"0": "101185",
										"1": "383",
										"2": "1"
									},
									{
										"0": "101890",
										"1": "2764",
										"2": "1"
									},
									{
										"0": "101225",
										"1": "1853",
										"2": "1"
									},
									{
										"0": "101890",
										"1": "3262",
										"2": "1"
									},
									{
										"0": "101242",
										"1": "4440",
										"2": "1"
									},
									{
										"0": "101901",
										"1": "2511",
										"2": "1"
									},
									{
										"0": "101269",
										"1": "2277",
										"2": "1"
									},
									{
										"0": "101901",
										"1": "3302",
										"2": "1"
									},
									{
										"0": "101288",
										"1": "4723",
										"2": "1"
									},
									{
										"0": "101910",
										"1": "168",
										"2": "1"
									},
									{
										"0": "101297",
										"1": "1737",
										"2": "1"
									},
									{
										"0": "101912",
										"1": "1876",
										"2": "1"
									},
									{
										"0": "101327",
										"1": "644",
										"2": "1"
									},
									{
										"0": "101923",
										"1": "4198",
										"2": "1"
									},
									{
										"0": "101790",
										"1": "1467",
										"2": "1"
									},
									{
										"0": "101935",
										"1": "4056",
										"2": "1"
									},
									{
										"0": "101359",
										"1": "1384",
										"2": "1"
									},
									{
										"0": "101938",
										"1": "3473",
										"2": "1"
									},
									{
										"0": "101383",
										"1": "2217",
										"2": "1"
									},
									{
										"0": "101951",
										"1": "431",
										"2": "1"
									},
									{
										"0": "101412",
										"1": "3287",
										"2": "1"
									},
									{
										"0": "101965",
										"1": "1153",
										"2": "1"
									},
									{
										"0": "101438",
										"1": "2392",
										"2": "1"
									},
									{
										"0": "101983",
										"1": "66",
										"2": "1"
									},
									{
										"0": "101466",
										"1": "4630",
										"2": "1"
									},
									{
										"0": "102006",
										"1": "3884",
										"2": "1"
									},
									{
										"0": "101499",
										"1": "932",
										"2": "1"
									},
									{
										"0": "102031",
										"1": "2984",
										"2": "1"
									},
									{
										"0": "101519",
										"1": "2718",
										"2": "1"
									},
									{
										"0": "102038",
										"1": "3384",
										"2": "1"
									},
									{
										"0": "101552",
										"1": "1113",
										"2": "1"
									},
									{
										"0": "102062",
										"1": "1143",
										"2": "1"
									},
									{
										"0": "101560",
										"1": "1452",
										"2": "1"
									},
									{
										"0": "102079",
										"1": "4449",
										"2": "1"
									},
									{
										"0": "101572",
										"1": "1330",
										"2": "1"
									},
									{
										"0": "102096",
										"1": "4955",
										"2": "1"
									},
									{
										"0": "101585",
										"1": "3317",
										"2": "1"
									},
									{
										"0": "102096",
										"1": "4936",
										"2": "1"
									},
									{
										"0": "101587",
										"1": "3663",
										"2": "1"
									},
									{
										"0": "102105",
										"1": "3171",
										"2": "1"
									},
									{
										"0": "101592",
										"1": "1286",
										"2": "1"
									},
									{
										"0": "102112",
										"1": "2916",
										"2": "1"
									},
									{
										"0": "101619",
										"1": "1982",
										"2": "1"
									},
									{
										"0": "102120",
										"1": "4255",
										"2": "1"
									},
									{
										"0": "101624",
										"1": "2126",
										"2": "1"
									},
									{
										"0": "102120",
										"1": "543",
										"2": "1"
									},
									{
										"0": "101658",
										"1": "606",
										"2": "1"
									},
									{
										"0": "102138",
										"1": "1937",
										"2": "1"
									},
									{
										"0": "101684",
										"1": "82",
										"2": "1"
									},
									{
										"0": "102144",
										"1": "4990",
										"2": "1"
									},
									{
										"0": "101696",
										"1": "437",
										"2": "1"
									},
									{
										"0": "102158",
										"1": "3430",
										"2": "1"
									},
									{
										"0": "101712",
										"1": "4114",
										"2": "1"
									},
									{
										"0": "102180",
										"1": "819",
										"2": "1"
									},
									{
										"0": "101721",
										"1": "1356",
										"2": "1"
									},
									{
										"0": "102204",
										"1": "697",
										"2": "1"
									},
									{
										"0": "101726",
										"1": "105",
										"2": "1"
									},
									{
										"0": "102206",
										"1": "986",
										"2": "1"
									},
									{
										"0": "101759",
										"1": "796",
										"2": "1"
									},
									{
										"0": "102212",
										"1": "1165",
										"2": "1"
									},
									{
										"0": "101789",
										"1": "4732",
										"2": "1"
									},
									{
										"0": "102228",
										"1": "3509",
										"2": "1"
									},
									{
										"0": "102311",
										"1": "536",
										"2": "1"
									},
									{
										"0": "102333",
										"1": "3924",
										"2": "1"
									},
									{
										"0": "101003",
										"1": "1823",
										"2": "1"
									},
									{
										"0": "102334",
										"1": "4714",
										"2": "1"
									},
									{
										"0": "101031",
										"1": "4784",
										"2": "1"
									},
									{
										"0": "102335",
										"1": "4322",
										"2": "1"
									},
									{
										"0": "101051",
										"1": "3236",
										"2": "1"
									},
									{
										"0": "102344",
										"1": "2944",
										"2": "1"
									},
									{
										"0": "101096",
										"1": "2361",
										"2": "1"
									},
									{
										"0": "102364",
										"1": "2850",
										"2": "1"
									},
									{
										"0": "101339",
										"1": "3863",
										"2": "1"
									},
									{
										"0": "102364",
										"1": "4526",
										"2": "1"
									},
									{
										"0": "101184",
										"1": "512",
										"2": "1"
									},
									{
										"0": "102367",
										"1": "217",
										"2": "1"
									},
									{
										"0": "101230",
										"1": "4447",
										"2": "1"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"8c1171e7-aec8-48b8-a60e-8eccf2a64b67": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "101939",
										"1": "4398",
										"2": "99"
									},
									{
										"0": "102925",
										"1": "758",
										"2": "99"
									},
									{
										"0": "101962",
										"1": "1369",
										"2": "99"
									},
									{
										"0": "101012",
										"1": "4603",
										"2": "99"
									},
									{
										"0": "101966",
										"1": "1949",
										"2": "99"
									},
									{
										"0": "101091",
										"1": "4846",
										"2": "99"
									},
									{
										"0": "101966",
										"1": "2493",
										"2": "99"
									},
									{
										"0": "101111",
										"1": "4732",
										"2": "99"
									},
									{
										"0": "101983",
										"1": "1158",
										"2": "99"
									},
									{
										"0": "101122",
										"1": "4663",
										"2": "99"
									},
									{
										"0": "101989",
										"1": "409",
										"2": "99"
									},
									{
										"0": "101155",
										"1": "3343",
										"2": "99"
									},
									{
										"0": "101990",
										"1": "835",
										"2": "99"
									},
									{
										"0": "101159",
										"1": "2988",
										"2": "99"
									},
									{
										"0": "101991",
										"1": "531",
										"2": "99"
									},
									{
										"0": "101202",
										"1": "3120",
										"2": "99"
									},
									{
										"0": "102002",
										"1": "4182",
										"2": "99"
									},
									{
										"0": "101223",
										"1": "3364",
										"2": "99"
									},
									{
										"0": "102004",
										"1": "4300",
										"2": "99"
									},
									{
										"0": "101252",
										"1": "4690",
										"2": "99"
									},
									{
										"0": "102006",
										"1": "3837",
										"2": "99"
									},
									{
										"0": "101302",
										"1": "4152",
										"2": "99"
									},
									{
										"0": "102013",
										"1": "1334",
										"2": "99"
									},
									{
										"0": "101325",
										"1": "855",
										"2": "99"
									},
									{
										"0": "102013",
										"1": "1575",
										"2": "99"
									},
									{
										"0": "101347",
										"1": "25",
										"2": "99"
									},
									{
										"0": "102014",
										"1": "287",
										"2": "99"
									},
									{
										"0": "101357",
										"1": "4171",
										"2": "99"
									},
									{
										"0": "102020",
										"1": "4882",
										"2": "99"
									},
									{
										"0": "101393",
										"1": "1265",
										"2": "99"
									},
									{
										"0": "102024",
										"1": "4791",
										"2": "99"
									},
									{
										"0": "101452",
										"1": "1788",
										"2": "99"
									},
									{
										"0": "102026",
										"1": "903",
										"2": "99"
									},
									{
										"0": "101477",
										"1": "13",
										"2": "99"
									},
									{
										"0": "102032",
										"1": "4207",
										"2": "99"
									},
									{
										"0": "101486",
										"1": "2121",
										"2": "99"
									},
									{
										"0": "102059",
										"1": "1098",
										"2": "99"
									},
									{
										"0": "101490",
										"1": "262",
										"2": "99"
									},
									{
										"0": "102063",
										"1": "1768",
										"2": "99"
									},
									{
										"0": "101504",
										"1": "4632",
										"2": "99"
									},
									{
										"0": "102069",
										"1": "4098",
										"2": "99"
									},
									{
										"0": "101537",
										"1": "2211",
										"2": "99"
									},
									{
										"0": "102089",
										"1": "4957",
										"2": "99"
									},
									{
										"0": "101564",
										"1": "2269",
										"2": "99"
									},
									{
										"0": "102096",
										"1": "2206",
										"2": "99"
									},
									{
										"0": "101577",
										"1": "1186",
										"2": "99"
									},
									{
										"0": "102111",
										"1": "3631",
										"2": "99"
									},
									{
										"0": "101600",
										"1": "4773",
										"2": "99"
									},
									{
										"0": "102123",
										"1": "4104",
										"2": "99"
									},
									{
										"0": "101608",
										"1": "4006",
										"2": "99"
									},
									{
										"0": "102130",
										"1": "4185",
										"2": "99"
									},
									{
										"0": "101623",
										"1": "4341",
										"2": "99"
									},
									{
										"0": "102153",
										"1": "2325",
										"2": "99"
									},
									{
										"0": "101641",
										"1": "2165",
										"2": "99"
									},
									{
										"0": "102172",
										"1": "3035",
										"2": "99"
									},
									{
										"0": "101664",
										"1": "1251",
										"2": "99"
									},
									{
										"0": "102201",
										"1": "1596",
										"2": "99"
									},
									{
										"0": "101677",
										"1": "4250",
										"2": "99"
									},
									{
										"0": "102203",
										"1": "1142",
										"2": "99"
									},
									{
										"0": "101692",
										"1": "3546",
										"2": "99"
									},
									{
										"0": "102209",
										"1": "1435",
										"2": "99"
									},
									{
										"0": "101699",
										"1": "3461",
										"2": "99"
									},
									{
										"0": "102210",
										"1": "1701",
										"2": "99"
									},
									{
										"0": "101711",
										"1": "566",
										"2": "99"
									},
									{
										"0": "102225",
										"1": "3208",
										"2": "99"
									},
									{
										"0": "101738",
										"1": "2956",
										"2": "99"
									},
									{
										"0": "102225",
										"1": "2752",
										"2": "99"
									},
									{
										"0": "101767",
										"1": "2658",
										"2": "99"
									},
									{
										"0": "102248",
										"1": "2200",
										"2": "99"
									},
									{
										"0": "101796",
										"1": "3720",
										"2": "99"
									},
									{
										"0": "102261",
										"1": "3410",
										"2": "99"
									},
									{
										"0": "101837",
										"1": "1824",
										"2": "99"
									},
									{
										"0": "102265",
										"1": "566",
										"2": "99"
									},
									{
										"0": "101847",
										"1": "1876",
										"2": "99"
									},
									{
										"0": "102276",
										"1": "2386",
										"2": "99"
									},
									{
										"0": "101879",
										"1": "1679",
										"2": "99"
									},
									{
										"0": "102289",
										"1": "2680",
										"2": "99"
									},
									{
										"0": "101885",
										"1": "1190",
										"2": "99"
									},
									{
										"0": "102297",
										"1": "2659",
										"2": "99"
									},
									{
										"0": "101906",
										"1": "3758",
										"2": "99"
									},
									{
										"0": "102298",
										"1": "3422",
										"2": "99"
									},
									{
										"0": "102379",
										"1": "4134",
										"2": "99"
									},
									{
										"0": "102380",
										"1": "1184",
										"2": "99"
									},
									{
										"0": "101178",
										"1": "3204",
										"2": "99"
									},
									{
										"0": "102387",
										"1": "1908",
										"2": "99"
									},
									{
										"0": "101095",
										"1": "1986",
										"2": "99"
									},
									{
										"0": "102393",
										"1": "209",
										"2": "99"
									},
									{
										"0": "101143",
										"1": "2416",
										"2": "99"
									},
									{
										"0": "102405",
										"1": "642",
										"2": "99"
									},
									{
										"0": "101160",
										"1": "1336",
										"2": "99"
									},
									{
										"0": "102418",
										"1": "2337",
										"2": "99"
									},
									{
										"0": "101242",
										"1": "2549",
										"2": "99"
									},
									{
										"0": "102442",
										"1": "4806",
										"2": "99"
									},
									{
										"0": "101325",
										"1": "3579",
										"2": "99"
									},
									{
										"0": "102458",
										"1": "2671",
										"2": "99"
									},
									{
										"0": "101349",
										"1": "1175",
										"2": "99"
									},
									{
										"0": "102470",
										"1": "3389",
										"2": "99"
									},
									{
										"0": "101400",
										"1": "2257",
										"2": "99"
									},
									{
										"0": "102486",
										"1": "2900",
										"2": "99"
									},
									{
										"0": "101481",
										"1": "1375",
										"2": "99"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"b99b4fde-3353-45cd-86f1-c4695669d84f": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "20"
									},
									{
										"0": "80001",
										"1": "20"
									},
									{
										"0": "80002",
										"1": "15"
									},
									{
										"0": "80003",
										"1": "12"
									},
									{
										"0": "80004",
										"1": "10"
									},
									{
										"0": "80005",
										"1": "13"
									},
									{
										"0": "80006",
										"1": "6"
									},
									{
										"0": "80007",
										"1": "18"
									},
									{
										"0": "80008",
										"1": "4"
									},
									{
										"0": "80009",
										"1": "16"
									},
									{
										"0": "80010",
										"1": "3"
									},
									{
										"0": "80011",
										"1": "17"
									},
									{
										"0": "80012",
										"1": "19"
									},
									{
										"0": "80013",
										"1": "6"
									},
									{
										"0": "80014",
										"1": "20"
									},
									{
										"0": "80015",
										"1": "12"
									},
									{
										"0": "80016",
										"1": "6"
									},
									{
										"0": "80017",
										"1": "1"
									},
									{
										"0": "80018",
										"1": "17"
									},
									{
										"0": "80019",
										"1": "14"
									},
									{
										"0": "80020",
										"1": "9"
									},
									{
										"0": "80021",
										"1": "18"
									},
									{
										"0": "80022",
										"1": "13"
									},
									{
										"0": "80023",
										"1": "10"
									},
									{
										"0": "80024",
										"1": "4"
									},
									{
										"0": "80025",
										"1": "13"
									},
									{
										"0": "80026",
										"1": "19"
									},
									{
										"0": "80027",
										"1": "13"
									},
									{
										"0": "80028",
										"1": "1"
									},
									{
										"0": "80029",
										"1": "4"
									},
									{
										"0": "80030",
										"1": "1"
									},
									{
										"0": "80031",
										"1": "9"
									},
									{
										"0": "80032",
										"1": "17"
									},
									{
										"0": "80033",
										"1": "8"
									},
									{
										"0": "80034",
										"1": "14"
									},
									{
										"0": "80035",
										"1": "11"
									},
									{
										"0": "80036",
										"1": "19"
									},
									{
										"0": "80037",
										"1": "10"
									},
									{
										"0": "80038",
										"1": "3"
									},
									{
										"0": "80039",
										"1": "4"
									},
									{
										"0": "80040",
										"1": "17"
									},
									{
										"0": "80041",
										"1": "6"
									},
									{
										"0": "80042",
										"1": "9"
									},
									{
										"0": "80043",
										"1": "2"
									},
									{
										"0": "80044",
										"1": "19"
									},
									{
										"0": "80045",
										"1": "6"
									},
									{
										"0": "80046",
										"1": "17"
									},
									{
										"0": "80047",
										"1": "4"
									},
									{
										"0": "80048",
										"1": "13"
									},
									{
										"0": "80049",
										"1": "16"
									},
									{
										"0": "80050",
										"1": "5"
									},
									{
										"0": "80051",
										"1": "17"
									},
									{
										"0": "80052",
										"1": "9"
									},
									{
										"0": "80053",
										"1": "4"
									},
									{
										"0": "80054",
										"1": "10"
									},
									{
										"0": "80055",
										"1": "18"
									},
									{
										"0": "80056",
										"1": "13"
									},
									{
										"0": "80057",
										"1": "9"
									},
									{
										"0": "80058",
										"1": "3"
									},
									{
										"0": "80059",
										"1": "14"
									},
									{
										"0": "80060",
										"1": "4"
									},
									{
										"0": "80061",
										"1": "6"
									},
									{
										"0": "80062",
										"1": "19"
									},
									{
										"0": "80063",
										"1": "3"
									},
									{
										"0": "80064",
										"1": "3"
									},
									{
										"0": "80066",
										"1": "4"
									},
									{
										"0": "80067",
										"1": "6"
									},
									{
										"0": "80068",
										"1": "5"
									},
									{
										"0": "80069",
										"1": "11"
									},
									{
										"0": "80070",
										"1": "8"
									},
									{
										"0": "80071",
										"1": "8"
									},
									{
										"0": "80072",
										"1": "5"
									},
									{
										"0": "80073",
										"1": "14"
									},
									{
										"0": "80074",
										"1": "12"
									},
									{
										"0": "80075",
										"1": "7"
									},
									{
										"0": "80076",
										"1": "12"
									},
									{
										"0": "80077",
										"1": "1"
									},
									{
										"0": "80078",
										"1": "6"
									},
									{
										"0": "80079",
										"1": "4"
									},
									{
										"0": "80080",
										"1": "19"
									},
									{
										"0": "80081",
										"1": "14"
									},
									{
										"0": "80082",
										"1": "15"
									},
									{
										"0": "80083",
										"1": "12"
									},
									{
										"0": "80084",
										"1": "5"
									},
									{
										"0": "80086",
										"1": "7"
									},
									{
										"0": "80087",
										"1": "1"
									},
									{
										"0": "80088",
										"1": "2"
									},
									{
										"0": "80089",
										"1": "9"
									},
									{
										"0": "80090",
										"1": "1"
									},
									{
										"0": "80091",
										"1": "10"
									},
									{
										"0": "80092",
										"1": "11"
									},
									{
										"0": "80093",
										"1": "6"
									},
									{
										"0": "80094",
										"1": "19"
									},
									{
										"0": "80095",
										"1": "1"
									},
									{
										"0": "80096",
										"1": "19"
									},
									{
										"0": "80097",
										"1": "19"
									},
									{
										"0": "80098",
										"1": "15"
									},
									{
										"0": "80099",
										"1": "8"
									},
									{
										"0": "80100",
										"1": "11"
									},
									{
										"0": "80101",
										"1": "6"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "total",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"b770019e-f81e-4c27-aa49-6d79556a5253": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80000",
										"1": "1054"
									},
									{
										"0": "80001",
										"1": "834"
									},
									{
										"0": "80002",
										"1": "754"
									},
									{
										"0": "80003",
										"1": "684"
									},
									{
										"0": "80004",
										"1": "598"
									},
									{
										"0": "80005",
										"1": "615"
									},
									{
										"0": "80006",
										"1": "348"
									},
									{
										"0": "80007",
										"1": "932"
									},
									{
										"0": "80008",
										"1": "199"
									},
									{
										"0": "80009",
										"1": "787"
									},
									{
										"0": "80010",
										"1": "97"
									},
									{
										"0": "80011",
										"1": "931"
									},
									{
										"0": "80012",
										"1": "1042"
									},
									{
										"0": "80013",
										"1": "313"
									},
									{
										"0": "80014",
										"1": "1084"
									},
									{
										"0": "80015",
										"1": "496"
									},
									{
										"0": "80016",
										"1": "429"
									},
									{
										"0": "80017",
										"1": "76"
									},
									{
										"0": "80018",
										"1": "733"
									},
									{
										"0": "80019",
										"1": "743"
									},
									{
										"0": "80020",
										"1": "502"
									},
									{
										"0": "80021",
										"1": "921"
									},
									{
										"0": "80022",
										"1": "662"
									},
									{
										"0": "80023",
										"1": "461"
									},
									{
										"0": "80024",
										"1": "143"
									},
									{
										"0": "80025",
										"1": "747"
									},
									{
										"0": "80026",
										"1": "909"
									},
									{
										"0": "80027",
										"1": "681"
									},
									{
										"0": "80028",
										"1": "72"
									},
									{
										"0": "80029",
										"1": "227"
									},
									{
										"0": "80030",
										"1": "4"
									},
									{
										"0": "80031",
										"1": "654"
									},
									{
										"0": "80032",
										"1": "877"
									},
									{
										"0": "80033",
										"1": "331"
									},
									{
										"0": "80034",
										"1": "651"
									},
									{
										"0": "80035",
										"1": "496"
									},
									{
										"0": "80036",
										"1": "1045"
									},
									{
										"0": "80037",
										"1": "476"
									},
									{
										"0": "80038",
										"1": "139"
									},
									{
										"0": "80039",
										"1": "211"
									},
									{
										"0": "80040",
										"1": "913"
									},
									{
										"0": "80041",
										"1": "290"
									},
									{
										"0": "80042",
										"1": "427"
									},
									{
										"0": "80043",
										"1": "24"
									},
									{
										"0": "80044",
										"1": "728"
									},
									{
										"0": "80045",
										"1": "314"
									},
									{
										"0": "80046",
										"1": "613"
									},
									{
										"0": "80047",
										"1": "194"
									},
									{
										"0": "80048",
										"1": "708"
									},
									{
										"0": "80049",
										"1": "981"
									},
									{
										"0": "80050",
										"1": "234"
									},
									{
										"0": "80051",
										"1": "788"
									},
									{
										"0": "80052",
										"1": "395"
									},
									{
										"0": "80053",
										"1": "234"
									},
									{
										"0": "80054",
										"1": "391"
									},
									{
										"0": "80055",
										"1": "1137"
									},
									{
										"0": "80056",
										"1": "440"
									},
									{
										"0": "80057",
										"1": "474"
									},
									{
										"0": "80058",
										"1": "50"
									},
									{
										"0": "80059",
										"1": "677"
									},
									{
										"0": "80060",
										"1": "158"
									},
									{
										"0": "80061",
										"1": "212"
									},
									{
										"0": "80062",
										"1": "1009"
									},
									{
										"0": "80063",
										"1": "113"
									},
									{
										"0": "80064",
										"1": "132"
									},
									{
										"0": "80066",
										"1": "141"
									},
									{
										"0": "80067",
										"1": "381"
									},
									{
										"0": "80068",
										"1": "329"
									},
									{
										"0": "80069",
										"1": "524"
									},
									{
										"0": "80070",
										"1": "422"
									},
									{
										"0": "80071",
										"1": "322"
									},
									{
										"0": "80072",
										"1": "352"
									},
									{
										"0": "80073",
										"1": "770"
									},
									{
										"0": "80074",
										"1": "398"
									},
									{
										"0": "80075",
										"1": "185"
									},
									{
										"0": "80076",
										"1": "425"
									},
									{
										"0": "80077",
										"1": "84"
									},
									{
										"0": "80078",
										"1": "383"
									},
									{
										"0": "80079",
										"1": "250"
									},
									{
										"0": "80080",
										"1": "946"
									},
									{
										"0": "80081",
										"1": "540"
									},
									{
										"0": "80082",
										"1": "566"
									},
									{
										"0": "80083",
										"1": "726"
									},
									{
										"0": "80084",
										"1": "257"
									},
									{
										"0": "80086",
										"1": "270"
									},
									{
										"0": "80087",
										"1": "20"
									},
									{
										"0": "80088",
										"1": "27"
									},
									{
										"0": "80089",
										"1": "488"
									},
									{
										"0": "80090",
										"1": "34"
									},
									{
										"0": "80091",
										"1": "314"
									},
									{
										"0": "80092",
										"1": "535"
									},
									{
										"0": "80093",
										"1": "279"
									},
									{
										"0": "80094",
										"1": "937"
									},
									{
										"0": "80095",
										"1": "42"
									},
									{
										"0": "80096",
										"1": "807"
									},
									{
										"0": "80097",
										"1": "984"
									},
									{
										"0": "80098",
										"1": "744"
									},
									{
										"0": "80099",
										"1": "375"
									},
									{
										"0": "80100",
										"1": "510"
									},
									{
										"0": "80101",
										"1": "222"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "totalItemsPurchased",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"8d386bd7-41d5-40fc-a83e-677ef418164c": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2857",
										"3": 4,
										"4": "20.080000000000000000",
										"5": "80.320000000000000000",
										"6": "20191230",
										"7": "24.000000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "1488",
										"3": 1,
										"4": "26.840000000000000000",
										"5": "26.840000000000000000",
										"6": "20191230",
										"7": "6.610000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "4021",
										"3": 3,
										"4": "31.120000000000000000",
										"5": "93.360000000000000000",
										"6": "20191230",
										"7": "28.110000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "728",
										"3": 1,
										"4": "28.390000000000000000",
										"5": "28.390000000000000000",
										"6": "20191230",
										"7": "9.740000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "3107",
										"3": 1,
										"4": "26.010000000000000000",
										"5": "26.010000000000000000",
										"6": "20191230",
										"7": "7.770000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2646",
										"3": 2,
										"4": "25.960000000000000000",
										"5": "51.920000000000000000",
										"6": "20191230",
										"7": "13.940000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2005",
										"3": 2,
										"4": "32.460000000000000000",
										"5": "64.920000000000000000",
										"6": "20191230",
										"7": "17.600000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "2848",
										"3": 4,
										"4": "20.200000000000000000",
										"5": "80.800000000000000000",
										"6": "20191230",
										"7": "28.600000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "248",
										"3": 2,
										"4": "25.490000000000000000",
										"5": "50.980000000000000000",
										"6": "20191230",
										"7": "13.340000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									},
									{
										"0": "6efc5ea6-36f6-4c4c-9129-56be367d9136",
										"1": "1",
										"2": "141",
										"3": 4,
										"4": "22.130000000000000000",
										"5": "88.520000000000000000",
										"6": "20191230",
										"7": "24.480000000000000000",
										"8": 19,
										"9": 38,
										"10": "7405"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "TransactionId",
										"type": "string"
									},
									{
										"key": "1",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "2",
										"name": "ProductId",
										"type": "smallint"
									},
									{
										"key": "3",
										"name": "Quantity",
										"type": "tinyint"
									},
									{
										"key": "4",
										"name": "Price",
										"type": "decimal"
									},
									{
										"key": "5",
										"name": "TotalAmount",
										"type": "decimal"
									},
									{
										"key": "6",
										"name": "TransactionDate",
										"type": "int"
									},
									{
										"key": "7",
										"name": "ProfitAmount",
										"type": "decimal"
									},
									{
										"key": "8",
										"name": "Hour",
										"type": "tinyint"
									},
									{
										"key": "9",
										"name": "Minute",
										"type": "tinyint"
									},
									{
										"key": "10",
										"name": "StoreId",
										"type": "smallint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"0"
									],
									"seriesFieldKeys": [
										"1"
									],
									"isStacked": false
								}
							}
						}
					},
					"b97bcc17-4481-4982-93a6-127086f8b25e": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "97875",
										"1": "3885",
										"2": "89"
									},
									{
										"0": "97876",
										"1": "1516",
										"2": "8"
									},
									{
										"0": "97876",
										"1": "3318",
										"2": "29"
									},
									{
										"0": "97876",
										"1": "4043",
										"2": "56"
									},
									{
										"0": "97876",
										"1": "1345",
										"2": "19"
									},
									{
										"0": "97876",
										"1": "3732",
										"2": "5"
									},
									{
										"0": "97876",
										"1": "4360",
										"2": "6"
									},
									{
										"0": "97877",
										"1": "4827",
										"2": "84"
									},
									{
										"0": "97877",
										"1": "3538",
										"2": "5"
									},
									{
										"0": "97877",
										"1": "1793",
										"2": "39"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "visitorId",
										"type": "bigint"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "itemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					},
					"972beed2-5613-4241-9d46-55e379954fdd": {
						"type": "Synapse.DataFrame",
						"sync_state": {
							"table": {
								"rows": [
									{
										"0": "80296",
										"1": "202",
										"2": "96.920000000000000000",
										"3": "4",
										"4": "52"
									},
									{
										"0": "80347",
										"1": "4232",
										"2": "48.860000000000000000",
										"3": "2",
										"4": "89"
									},
									{
										"0": "80351",
										"1": "244",
										"2": "83.960000000000000000",
										"3": "4",
										"4": "83"
									},
									{
										"0": "80659",
										"1": "2433",
										"2": "45.520000000000000000",
										"3": "2",
										"4": "63"
									},
									{
										"0": "80922",
										"1": "963",
										"2": "100.680000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "81027",
										"1": "2158",
										"2": "43.460000000000000000",
										"3": "2",
										"4": "54"
									},
									{
										"0": "81180",
										"1": "109",
										"2": "207.920000000000000000",
										"3": "8",
										"4": "50"
									},
									{
										"0": "81686",
										"1": "3128",
										"2": "64.240000000000000000",
										"3": "2",
										"4": "93"
									},
									{
										"0": "82401",
										"1": "87",
										"2": "18.430000000000000000",
										"3": "1",
										"4": "56"
									},
									{
										"0": "82442",
										"1": "3318",
										"2": "152.040000000000000000",
										"3": "4",
										"4": "53"
									},
									{
										"0": "82467",
										"1": "3033",
										"2": "72.720000000000000000",
										"3": "3",
										"4": "32"
									},
									{
										"0": "82625",
										"1": "104",
										"2": "35.230000000000000000",
										"3": "1",
										"4": "58"
									},
									{
										"0": "82983",
										"1": "802",
										"2": "58.800000000000000000",
										"3": "2",
										"4": "4"
									},
									{
										"0": "83417",
										"1": "24",
										"2": "22.280000000000000000",
										"3": "1",
										"4": "60"
									},
									{
										"0": "83425",
										"1": "158",
										"2": "45.240000000000000000",
										"3": "2",
										"4": "26"
									},
									{
										"0": "83704",
										"1": "3164",
										"2": "116.880000000000000000",
										"3": "4",
										"4": "53"
									},
									{
										"0": "84189",
										"1": "103",
										"2": "51.780000000000000000",
										"3": "2",
										"4": "29"
									},
									{
										"0": "84245",
										"1": "177",
										"2": "68.940000000000000000",
										"3": "3",
										"4": "5"
									},
									{
										"0": "84418",
										"1": "4412",
										"2": "64.800000000000000000",
										"3": "2",
										"4": "70"
									},
									{
										"0": "84464",
										"1": "2043",
										"2": "66.600000000000000000",
										"3": "3",
										"4": "11"
									},
									{
										"0": "84483",
										"1": "1335",
										"2": "115.560000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "84543",
										"1": "1379",
										"2": "29.290000000000000000",
										"3": "1",
										"4": "87"
									},
									{
										"0": "84558",
										"1": "116",
										"2": "49.380000000000000000",
										"3": "3",
										"4": "10"
									},
									{
										"0": "84833",
										"1": "63",
										"2": "31.670000000000000000",
										"3": "1",
										"4": "41"
									},
									{
										"0": "85070",
										"1": "4882",
										"2": "58.740000000000000000",
										"3": "2",
										"4": "92"
									},
									{
										"0": "85161",
										"1": "162",
										"2": "64.420000000000000000",
										"3": "2",
										"4": "99"
									},
									{
										"0": "85170",
										"1": "2934",
										"2": "103.860000000000000000",
										"3": "6",
										"4": "52"
									},
									{
										"0": "85501",
										"1": "682",
										"2": "74.280000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "86205",
										"1": "3173",
										"2": "52.940000000000000000",
										"3": "2",
										"4": "15"
									},
									{
										"0": "86205",
										"1": "115",
										"2": "61.580000000000000000",
										"3": "2",
										"4": "53"
									},
									{
										"0": "86349",
										"1": "768",
										"2": "127.440000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "86456",
										"1": "347",
										"2": "29.590000000000000000",
										"3": "1",
										"4": "52"
									},
									{
										"0": "86557",
										"1": "4475",
										"2": "86.640000000000000000",
										"3": "4",
										"4": "37"
									},
									{
										"0": "86629",
										"1": "200",
										"2": "74.340000000000000000",
										"3": "3",
										"4": "32"
									},
									{
										"0": "86641",
										"1": "72",
										"2": "52.060000000000000000",
										"3": "2",
										"4": "9"
									},
									{
										"0": "86811",
										"1": "3635",
										"2": "88.800000000000000000",
										"3": "3",
										"4": "51"
									},
									{
										"0": "86846",
										"1": "152",
										"2": "75.870000000000000000",
										"3": "3",
										"4": "72"
									},
									{
										"0": "87075",
										"1": "1777",
										"2": "139.240000000000000000",
										"3": "4",
										"4": "35"
									},
									{
										"0": "87086",
										"1": "2362",
										"2": "35.520000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "87095",
										"1": "2911",
										"2": "65.720000000000000000",
										"3": "2",
										"4": "80"
									},
									{
										"0": "87103",
										"1": "92",
										"2": "77.750000000000000000",
										"3": "5",
										"4": "82"
									},
									{
										"0": "87126",
										"1": "172",
										"2": "36.970000000000000000",
										"3": "1",
										"4": "46"
									},
									{
										"0": "87126",
										"1": "154",
										"2": "52.280000000000000000",
										"3": "2",
										"4": "92"
									},
									{
										"0": "87142",
										"1": "101",
										"2": "127.500000000000000000",
										"3": "3",
										"4": "60"
									},
									{
										"0": "87314",
										"1": "2885",
										"2": "26.610000000000000000",
										"3": "1",
										"4": "67"
									},
									{
										"0": "87480",
										"1": "3496",
										"2": "94.620000000000000000",
										"3": "3",
										"4": "56"
									},
									{
										"0": "87546",
										"1": "3918",
										"2": "74.460000000000000000",
										"3": "3",
										"4": "70"
									},
									{
										"0": "87607",
										"1": "2307",
										"2": "141.720000000000000000",
										"3": "4",
										"4": "17"
									},
									{
										"0": "87690",
										"1": "114",
										"2": "153.920000000000000000",
										"3": "4",
										"4": "76"
									},
									{
										"0": "88259",
										"1": "2396",
										"2": "23.530000000000000000",
										"3": "1",
										"4": "22"
									},
									{
										"0": "88440",
										"1": "5",
										"2": "50.620000000000000000",
										"3": "2",
										"4": "23"
									},
									{
										"0": "88485",
										"1": "226",
										"2": "71.790000000000000000",
										"3": "3",
										"4": "20"
									},
									{
										"0": "88518",
										"1": "2287",
										"2": "46.480000000000000000",
										"3": "2",
										"4": "16"
									},
									{
										"0": "88750",
										"1": "633",
										"2": "65.320000000000000000",
										"3": "2",
										"4": "30"
									},
									{
										"0": "88796",
										"1": "885",
										"2": "26.170000000000000000",
										"3": "1",
										"4": "17"
									},
									{
										"0": "88858",
										"1": "199",
										"2": "66.660000000000000000",
										"3": "2",
										"4": "45"
									},
									{
										"0": "89226",
										"1": "3769",
										"2": "20.630000000000000000",
										"3": "1",
										"4": "12"
									},
									{
										"0": "89283",
										"1": "1772",
										"2": "105.840000000000000000",
										"3": "4",
										"4": "34"
									},
									{
										"0": "89976",
										"1": "2006",
										"2": "74.240000000000000000",
										"3": "4",
										"4": "51"
									},
									{
										"0": "90083",
										"1": "315",
										"2": "118.880000000000000000",
										"3": "4",
										"4": "9"
									},
									{
										"0": "90131",
										"1": "4896",
										"2": "46.260000000000000000",
										"3": "2",
										"4": "34"
									},
									{
										"0": "90335",
										"1": "1441",
										"2": "21.270000000000000000",
										"3": "1",
										"4": "1"
									},
									{
										"0": "90367",
										"1": "3575",
										"2": "136.320000000000000000",
										"3": "4",
										"4": "39"
									},
									{
										"0": "90652",
										"1": "34",
										"2": "88.000000000000000000",
										"3": "4",
										"4": "79"
									},
									{
										"0": "90671",
										"1": "195",
										"2": "24.140000000000000000",
										"3": "1",
										"4": "7"
									},
									{
										"0": "91493",
										"1": "4549",
										"2": "17.750000000000000000",
										"3": "1",
										"4": "31"
									},
									{
										"0": "91646",
										"1": "202",
										"2": "72.690000000000000000",
										"3": "3",
										"4": "51"
									},
									{
										"0": "91798",
										"1": "224",
										"2": "125.970000000000000000",
										"3": "3",
										"4": "62"
									},
									{
										"0": "91817",
										"1": "3651",
										"2": "101.820000000000000000",
										"3": "3",
										"4": "40"
									},
									{
										"0": "92030",
										"1": "98",
										"2": "83.250000000000000000",
										"3": "3",
										"4": "88"
									},
									{
										"0": "92293",
										"1": "27",
										"2": "95.280000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "92456",
										"1": "242",
										"2": "104.560000000000000000",
										"3": "4",
										"4": "98"
									},
									{
										"0": "92543",
										"1": "173",
										"2": "95.320000000000000000",
										"3": "4",
										"4": "60"
									},
									{
										"0": "92565",
										"1": "4069",
										"2": "87.480000000000000000",
										"3": "3",
										"4": "93"
									},
									{
										"0": "92581",
										"1": "94",
										"2": "85.680000000000000000",
										"3": "3",
										"4": "54"
									},
									{
										"0": "92623",
										"1": "2015",
										"2": "31.660000000000000000",
										"3": "1",
										"4": "43"
									},
									{
										"0": "92794",
										"1": "2252",
										"2": "23.790000000000000000",
										"3": "1",
										"4": "80"
									},
									{
										"0": "92961",
										"1": "780",
										"2": "68.340000000000000000",
										"3": "3",
										"4": "66"
									},
									{
										"0": "93136",
										"1": "169",
										"2": "155.160000000000000000",
										"3": "4",
										"4": "74"
									},
									{
										"0": "93204",
										"1": "464",
										"2": "92.480000000000000000",
										"3": "4",
										"4": "13"
									},
									{
										"0": "93507",
										"1": "170",
										"2": "55.700000000000000000",
										"3": "2",
										"4": "84"
									},
									{
										"0": "93533",
										"1": "81",
										"2": "51.560000000000000000",
										"3": "2",
										"4": "19"
									},
									{
										"0": "93687",
										"1": "124",
										"2": "26.150000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "93837",
										"1": "2194",
										"2": "77.550000000000000000",
										"3": "3",
										"4": "65"
									},
									{
										"0": "94256",
										"1": "2939",
										"2": "24.670000000000000000",
										"3": "1",
										"4": "27"
									},
									{
										"0": "94337",
										"1": "3143",
										"2": "43.700000000000000000",
										"3": "2",
										"4": "48"
									},
									{
										"0": "94573",
										"1": "4276",
										"2": "28.970000000000000000",
										"3": "1",
										"4": "9"
									},
									{
										"0": "94643",
										"1": "213",
										"2": "87.210000000000000000",
										"3": "3",
										"4": "12"
									},
									{
										"0": "94839",
										"1": "4472",
										"2": "25.260000000000000000",
										"3": "1",
										"4": "89"
									},
									{
										"0": "94914",
										"1": "4767",
										"2": "63.000000000000000000",
										"3": "3",
										"4": "87"
									},
									{
										"0": "95324",
										"1": "4866",
										"2": "142.920000000000000000",
										"3": "4",
										"4": "3"
									},
									{
										"0": "95392",
										"1": "27",
										"2": "95.280000000000000000",
										"3": "3",
										"4": "41"
									},
									{
										"0": "95546",
										"1": "3393",
										"2": "91.350000000000000000",
										"3": "3",
										"4": "96"
									},
									{
										"0": "95760",
										"1": "4458",
										"2": "34.270000000000000000",
										"3": "1",
										"4": "78"
									},
									{
										"0": "95776",
										"1": "2138",
										"2": "111.960000000000000000",
										"3": "4",
										"4": "47"
									},
									{
										"0": "95857",
										"1": "4837",
										"2": "26.750000000000000000",
										"3": "1",
										"4": "27"
									},
									{
										"0": "95903",
										"1": "135",
										"2": "72.480000000000000000",
										"3": "2",
										"4": "18"
									},
									{
										"0": "96097",
										"1": "4987",
										"2": "74.900000000000000000",
										"3": "2",
										"4": "52"
									},
									{
										"0": "96124",
										"1": "3319",
										"2": "119.480000000000000000",
										"3": "4",
										"4": "33"
									},
									{
										"0": "96219",
										"1": "3269",
										"2": "40.040000000000000000",
										"3": "2",
										"4": "10"
									}
								],
								"schema": [
									{
										"key": "0",
										"name": "CustomerId",
										"type": "int"
									},
									{
										"key": "1",
										"name": "productId",
										"type": "bigint"
									},
									{
										"key": "2",
										"name": "TotalAmountDecember",
										"type": "decimal"
									},
									{
										"key": "3",
										"name": "TotalQuantityDecember",
										"type": "bigint"
									},
									{
										"key": "4",
										"name": "TotalItemsPurchasedLast12Months",
										"type": "bigint"
									}
								],
								"truncated": false
							},
							"isSummary": false,
							"language": "scala"
						},
						"persist_state": {
							"view": {
								"type": "details",
								"chartOptions": {
									"chartType": "bar",
									"aggregationType": "sum",
									"categoryFieldKeys": [
										"1"
									],
									"seriesFieldKeys": [
										"0"
									],
									"isStacked": false
								}
							}
						}
					}
				}
			},
			"enableDebugMode": false,
			"kernelspec": {
				"name": "synapse_pyspark",
				"display_name": "Synapse PySpark"
			},
			"language_info": {
				"name": "python"
			},
			"a365ComputeOptions": {
				"id": "/subscriptions/03a109b4-71f9-46b4-8b72-afaef0bbfbf3/resourceGroups/data-engineering-synapse-xhwrzef/providers/Microsoft.Synapse/workspaces/asaworkspacexhwrzef/bigDataPools/SparkPool01",
				"name": "SparkPool01",
				"type": "Spark",
				"endpoint": "https://asaworkspacexhwrzef.dev.azuresynapse.net/livyApi/versions/2019-11-01-preview/sparkPools/SparkPool01",
				"auth": {
					"type": "AAD",
					"authResource": "https://dev.azuresynapse.net",
					"authHeader": null
				},
				"sparkVersion": "2.4",
				"nodeCount": 3,
				"cores": 4,
				"memory": 28,
				"extraHeader": null
			},
			"sessionKeepAliveTimeout": 30
		},
		"cells": [
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Exercise 2 - Ingesting data with Spark notebooks in Azure Synapse Analytics\r\n",
					"Tailwind Traders has unstructured and semi-structured files from various data sources. Their data engineers want to use their Spark expertise to explore, ingest, and transform these files.\r\n",
					"\r\n",
					"You recommend using Synapse Notebooks, which are integrated in the Azure Synapse Analytics workspace and used from within Synapse Studio.\r\n",
					"\r\n",
					"Task 1: Ingest and explore Parquet files from a data lake with Apache Spark for Azure Synapse\r\n",
					"In Azure Synapse Studio, select the Data hub.\r\n",
					"\r\n",
					"On the Linked tab, in the wwi-02 container, browse to the sale-small/Year=2019/Quarter=Q4/Month=12/Day=20191231 folder. Then right-click the Parquet file, select New notebook, and then select Load to DataFrame."
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"microsoft": {
						"language": "python"
					},
					"collapsed": false
				},
				"source": [
					"%%pyspark\r\n",
					"df = spark.read.load('abfss://wwi-02@asadatalakexhwrzef.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/Day=20191231/sale-small-20191231-snappy.parquet', format='parquet')\r\n",
					"display(df.limit(10))\r\n",
					"\r\n",
					"datalake = 'asadatalakexhwrzef'"
				],
				"attachments": null,
				"execution_count": 2
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df.printSchema()"
				],
				"attachments": null,
				"execution_count": 3
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"from pyspark.sql import SparkSession\r\n",
					"from pyspark.sql.types import *\r\n",
					"from pyspark.sql.functions import *\r\n",
					"\r\n",
					"profitByDateProduct = (df.groupBy(\"TransactionDate\",\"ProductId\")\r\n",
					"    .agg(\r\n",
					"        sum(\"ProfitAmount\").alias(\"(sum)ProfitAmount\"),\r\n",
					"        round(avg(\"Quantity\"), 4).alias(\"(avg)Quantity\"),\r\n",
					"        sum(\"Quantity\").alias(\"(sum)Quantity\"))\r\n",
					"    .orderBy(\"TransactionDate\"))\r\n",
					"display(profitByDateProduct.limit(100))"
				],
				"attachments": null,
				"execution_count": 4
			},
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Exercise 3 - Transforming data with DataFrames in Spark pools in Azure Synapse Analytics\r\n",
					"In addition to the sales data, Tailwind Traders has customer profile data from an e-commerce system that provides top product purchases for each visitor of the site (customer) over the past 12 months. This data is stored within JSON files in the data lake. They have struggled with ingesting, exploring, and transforming these JSON files and want your guidance. The files have a hierarchical structure that they want to flatten before loading into relational data stores. They also wish to apply grouping and aggregate operations as part of the data engineering process. You recommend using Synapse Notebooks to explore and apply data transformations on the JSON files.\r\n",
					"\r\n",
					"Task 1: Query and transform JSON data with Apache Spark for Azure Synapse\r\n",
					"Create a new code cell in the Spark notebook, enter the following code and run the cell:"
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df = spark.read \\\r\n",
					"        .option('inferSchema', 'true') \\\r\n",
					"        .json('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/online-user-profiles-02/*.json', multiLine=True)\r\n",
					"\r\n",
					"df.printSchema()"
				],
				"attachments": null,
				"execution_count": 5
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"df.createOrReplaceTempView(\"user_profiles\")"
				],
				"attachments": null,
				"execution_count": 6
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "sparksql"
					},
					"collapsed": false
				},
				"source": [
					"%%sql\r\n",
					"\r\n",
					"SELECT * FROM user_profiles LIMIT 10"
				],
				"attachments": null,
				"execution_count": 7
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"from pyspark.sql.functions import udf, explode\r\n",
					"\r\n",
					"flat = df.select(\"visitorId\", explode(\"topProductPurchases\").alias(\"topProductPurchases_flat\"))\r\n",
					"flat.show(100)"
				],
				"attachments": null,
				"execution_count": 9
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"topPurchases = (flat.select('visitorId','topProductPurchases_flat.productId','topProductPurchases_flat.itemsPurchasedLast12Months')\r\n",
					"    .orderBy('visitorId'))\r\n",
					"\r\n",
					"topPurchases.show(100)"
				],
				"attachments": null,
				"execution_count": 10
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"sortedTopPurchases = topPurchases.orderBy(\"itemsPurchasedLast12Months\")\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))"
				],
				"attachments": null,
				"execution_count": 11
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"sortedTopPurchases = topPurchases.orderBy( col(\"itemsPurchasedLast12Months\").desc() )\r\n",
					"\r\n",
					"display(sortedTopPurchases.limit(100))"
				],
				"attachments": null,
				"execution_count": 12
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = sortedTopPurchases.select(\"visitorId\").groupBy(\"visitorId\").agg(count(\"*\").alias(\"total\")).orderBy(\"visitorId\")\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))"
				],
				"attachments": null,
				"execution_count": 14
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"groupedTopPurchases = (sortedTopPurchases.select(\"visitorId\",\"itemsPurchasedLast12Months\")\r\n",
					"    .groupBy(\"visitorId\")\r\n",
					"    .agg(sum(\"itemsPurchasedLast12Months\").alias(\"totalItemsPurchased\"))\r\n",
					"    .orderBy(\"visitorId\") )\r\n",
					"\r\n",
					"display(groupedTopPurchases.limit(100))"
				],
				"attachments": null,
				"execution_count": 15
			},
			{
				"cell_type": "markdown",
				"metadata": {
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"# Exercise 4 - Integrating SQL and Spark pools in Azure Synapse Analytics\r\n",
					"Tailwind Traders wants to write to the SQL database associated with dedicated SQL pool after performing data engineering tasks in Spark, then reference that SQL database as a source for joining with Spark dataframes that contain data from other files.\r\n",
					"\r\n",
					"You decide to use the Apache Spark to Synapse SQL connector to efficiently transfer data between Spark databases and SQL databases in Azure Synapse.\r\n",
					"\r\n",
					"Transferring data between Spark databases and SQL databases can be done using JDBC. However, given two distributed systems such as Spark pools and SQL pools, JDBC tends to be a bottleneck with serial data transfer.\r\n",
					"\r\n",
					"The Apache Spark pool to Synapse SQL connector is a data source implementation for Apache Spark. It uses the Azure Data Lake Storage Gen2 and PolyBase in dedicated SQL pools to efficiently transfer data between the Spark cluster and the Synapse SQL instance.\r\n",
					"\r\n",
					"Task 1: Update notebook\r\n",
					"We have been using Python code in these cells up to this point. If we want to use the Apache Spark pool to Synapse SQL connector, one option is to create a temporary view of the data within the dataframe. Run the following in a new code cell to create a view named top_purchases:"
				],
				"attachments": null
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					}
				},
				"source": [
					"topPurchases.createOrReplaceTempView(\"top_purchases\")"
				],
				"attachments": null,
				"execution_count": 16
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					}
				},
				"source": [
					"%%spark\r\n",
					"val df = spark.sqlContext.sql(\"select * from top_purchases\")\r\n",
					"df.write.synapsesql(\"SQLPool01.wwi.TopPurchases\", Constants.INTERNAL)"
				],
				"attachments": null,
				"execution_count": 17
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfsales = spark.read.load('abfss://wwi-02@' + datalake + '.dfs.core.windows.net/sale-small/Year=2019/Quarter=Q4/Month=12/*/*.parquet', format='parquet')\r\n",
					"display(dfsales.limit(10))"
				],
				"attachments": null,
				"execution_count": 18
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"microsoft": {
						"language": "scala"
					}
				},
				"source": [
					"%%spark\r\n",
					"\r\n",
					"val df2 = spark.read.synapsesql(\"SQLPool01.wwi.TopPurchases\")\r\n",
					"df2.createTempView(\"top_purchases_sql\")\r\n",
					"\r\n",
					"df2.head(10)"
				],
				"attachments": null,
				"execution_count": 19
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"dfTopPurchasesFromSql = sqlContext.table(\"top_purchases_sql\")\r\n",
					"\r\n",
					"display(dfTopPurchasesFromSql.limit(10))"
				],
				"attachments": null,
				"execution_count": 20
			},
			{
				"cell_type": "code",
				"metadata": {
					"jupyter": {
						"source_hidden": false,
						"outputs_hidden": false
					},
					"nteract": {
						"transient": {
							"deleting": false
						}
					},
					"collapsed": false
				},
				"source": [
					"inner_join = dfsales.join(dfTopPurchasesFromSql, \r\n",
					"    (dfsales.CustomerId == dfTopPurchasesFromSql.visitorId) & (dfsales.ProductId == dfTopPurchasesFromSql.productId))\r\n",
					"\r\n",
					"inner_join_agg = inner_join.select(\"CustomerId\", \"TotalAmount\", \"Quantity\", \"itemsPurchasedLast12Months\", \"top_purchases_sql.productId\") \\\r\n",
					"    .groupBy([\"CustomerId\", \"top_purchases_sql.productId\"]) \\\r\n",
					"    .agg(\r\n",
					"        sum(\"TotalAmount\").alias(\"TotalAmountDecember\"),\r\n",
					"        sum(\"Quantity\").alias(\"TotalQuantityDecember\"),\r\n",
					"        sum(\"itemsPurchasedLast12Months\").alias(\"TotalItemsPurchasedLast12Months\")).orderBy(\"CustomerId\")\r\n",
					"\r\n",
					"display(inner_join_agg.limit(100))"
				],
				"attachments": null,
				"execution_count": 24
			}
		]
	}
}